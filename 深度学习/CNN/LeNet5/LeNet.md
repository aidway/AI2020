# LeNet5

![LeNet](E:\git\AI2020\深度学习\CNN\LeNet5\imgs\LeNet.png)

## 模型概述

​	LeNet分为**卷积层块**和**全连接层**块两个部分：

- 卷积层块

  1. 基本单位是卷积+池化：卷积用来识别图像里的空间模式，如线条和物体局部，之后的池化层用来降低卷积层对位置的敏感性。
  2. 卷积层块由两个类似的基本单位构成，卷积层的kernel都为5x5，并在输出上使用sigmoid函数。第一个卷积层的输出通道为6，第二个卷积层的输出通道为16。

- 全连接层块

  1. 包含3个全连接层，输出个数分别是120、84和10，其中10为输出的类别个数。

  

  ​	**注意：LeNet在连接卷积层块到全连接层块时，需要做一次数据展平操作。**

## 模型结构

### **输入层**-Input层

​	batch_size  * height * width * channel

​	1张单通道图片：1 * 32 * 32 * 1

### **C1层**-卷积层

​	输入：1 * 32 * 32 * 1

​	卷积核：6 个， 5 * 5 * 1

​	输出：6 * 28 * 28 * 1

​	参数个数：（5 * 5 + 1） * 6 = 156，其中，5 * 5为卷积核的25个参数，1为偏置

​	连接数/计算量/FLOPs：（5 * 5 + 1） * （28 * 28） *  6 = 122304

<img src="E:\git\AI2020\深度学习\CNN\LeNet5\imgs\C1.png" alt="C1" style="zoom:50%;" />

### **S2层**-池化层

​	输入：6 * 28 * 28 * 1

​	采样：2 * 2

​	输出：6 * 14 * 14 * 1

​	参数个数：（1+1）* 6=12，其中第一个1为最大池化所对应的2*2感受野中最大的那个数的权重，第二个1为偏置

​	连接数：（2 * 2+1）* （14 * 14 ）* 6= 5880，虽然只选取2 * 2感受野中最大的那个数，但也存在2*2的连接数，即最大的权重为1，其余的为0

<img src="E:\git\AI2020\深度学习\CNN\LeNet5\imgs\S2.png" alt="S2" style="zoom:60%;" />

### **C3层**-卷积层

​	输入：6 * 14 * 14 * 1

​	卷积核：16 个，padding=0，stride=1， 5 * 5 * N 	(N取3、4、4、6)

​	输出：16 * 10 * 10 * 1

​	参数个数：（5 * 5 *  3+1） * 6+（5 * 5 * 4+1） * 6+（5 * 5 * 4+1） * 3+（5 * 5 * 6+1）=1516

​	连接数：1516 * （10 * 10）=151600



​	**问题1：6个输入图如何通过卷积得到16个特征图？**

​	C3的前六个特征图(0,1,2,3,4,5)由S2的相邻三个特征图作为输入，接下来的6个特征图(6,7,8,9,10,11)由S2的相邻四个特征图作为输入，12,13,14号特征图由S2间断的四个特征图作为输入，15号特征图由S2全部(6个)特征图作为输入，如下图所示：

<img src="E:\git\AI2020\深度学习\CNN\LeNet5\imgs\C3.png" alt="C3" style="zoom:67%;" />

​	**问题2：通过S2的输入，如何卷积得到C3的一个特征图呢？**

​	用C3层0号特征图举例，它由S2层0,1,2号特征图作为输入，由于C3层共有16个卷积核，即C3每一个特征图是由**一个卷积核**对S2层相应的输入特征图卷积得到的，每类卷积核通道各不相同，如下图所示：

<img src="E:\git\AI2020\深度学习\CNN\LeNet5\imgs\C3_2.png" alt="C3_2" style="zoom:60%;" />

### **S4层**-池化层

​	输入：16 * 10 * 10 * 1

​	采样：16个，padding=0，stride=2，2 * 2

​	输出：16 * 5 * 5 * 1

​	参数个数：（1+1） * 16 = 32

​	连接个数：（2 * 2 + 1）* （5 * 5） * 16 =2000

### **C5层-**卷积层

​	输入：16 * 5 * 5 * 1

​	卷积核：120个， 5 * 5 * 16 	

​	输出：120 * 1 * 1 * 1

​	参数个数：（5 * 5 * 16 + 1） * 120 = 48120

​	连接个数：（5 * 5 * 16 + 1） * （1 * 1） * 120=48120

### **F6层**-全连接层

​	输入：1 * 120		（**将数据进行展平**）

​	神经元个数：84

​	输出：1 * 84

​	参数个数：（120 + 1） * 84 = 10164

​	连接个数：（120 + 1） * 84 = 10164

### **Output层**-全连接层

​	输入：1 * 84		

​	神经元个数：10

​	输出：1 * 10

​	参数个数：84 * 10 = 840

​	连接个数：84 * 10 = 840

# 参考

1. https://blog.csdn.net/saw009/article/details/80590245